module map (
    input clk,  // clock
    input rst,  // reset

    input button_stage_left,
    input button_stage_right,
    input win_bool_in,
    input loss_bool_in,

    output map_out[256],
    output player_position_out[16],
    output win_position_out[8],
    output map_index[2]
  ) 

{
  .clk(clk){
    .rst(rst){
      fsm map_fsm = {MAP1, MAP2, MAP3};
    }
  }
  
  always {
    
    map_out = 0;
    player_position_out = 0;
    win_position_out = 0;
    map_index = 0;

    case(map_fsm.q){
        map_fsm.MAP1:
            map_out = 256b0000000000000000000000000000000000000000000000000000000000000000000000000000000000011100000000000001111110000000000111111111000000001111111110000000000011111000000000000111000000000000000000000000000000000000000000000000000000000000000000000000000000000000;
            player_position_out[15:8] = 100;
            win_position_out = 154;
            map_index = 1;

            if(win_bool_in){
                map_fsm.d = map_fsm.MAP2;
            }

            if(button_stage_right){
                map_fsm.d = map_fsm.MAP2;
            }

        map_fsm.MAP2:
            map_out = 256b0000000000000000000000000000000000000000000000000000011111100000000001001110000000000100111110000111110000011110000011100001111000001110000011100000001001100000000000111110000000000011111000000000000111000000000000000000000000000000000000000000000000000000;
            player_position_out[15:8] = 97;
            win_position_out = 125;
            map_index = 2;

            if(win_bool_in){
                map_fsm.d = map_fsm.MAP3;
            }

            if(button_stage_right){
                map_fsm.d = map_fsm.MAP3;
            }

        map_fsm.MAP3:
            map_out = 256b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111110001111001110011000111111111001111011110000000111101111000000011110000000000000111000000000000000000000000000000000000000000000000000000000000000000000000000000000;
            player_position_out[15:8] = 129;
            win_position_out = 141;
            map_index = 3;

            if(win_bool_in){
                map_fsm.d = map_fsm.MAP1;
            }

            if(button_stage_right){
                map_fsm.d = map_fsm.MAP1;
            }


        default:
            player_position_out = 0;
    }
    
  }
}
